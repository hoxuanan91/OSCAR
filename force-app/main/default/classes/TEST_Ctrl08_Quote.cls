@isTest
public class TEST_Ctrl08_Quote{

    @testSetup 
    static void MethodPrepare() {
        User u = TestFactory.createUser();
        u.UserByPassWorkflows__c = true;
        u.UserByPassTriggers__c = 'OpportunityBeforeUpdate';

        System.runAs(u){
            RecordType lRecordTypeOpp   = [SELECT Id, Name FROM RecordType WHERE DeveloperName = 'CBIProjetAssocie' and SobjectType = 'Opportunity'];
            RecordType lRecordTypeTiers = [SELECT Id, Name FROM RecordType WHERE DeveloperName = 'Tiers'  and SobjectType = 'Account'] ;
            Map<String,Id>mapBDD_RT=new Map<String,Id>();
            for(RecordType RT:[Select Id,DeveloperName from RecordType where SObjectType='BddRoe__c']){
                mapBDD_RT.put(RT.DeveloperName,RT.Id);
            }
            Account lTiers = new Account(Name = 'Test', RecordTypeId = lRecordTypeTiers.Id);
            insert lTiers;      
            
            Projet__c lProjet = new Projet__c(Name = 'Test', NomDuTiers__c = lTiers.Id);
            insert lProjet;
                
            Opportunity lOpportunity = new Opportunity(
                    Name = 'Test Quote Triggers',
                    RecordTypeId = lRecordTypeOpp.Id,
                    NomDuProjet__c = lProjet.Id,
                    AccountId = lTiers.Id,
                    TypeDOperation__c = 'Construction',
                    StageName = 'Pré-Etude',
                    Jalon__c='Nouveau Projet',
                    Amount =  3950000,
                    PreloyersDEngagement__c =  0.10,
                    PreloyersDeTVAPerc__c = 1.5,
                    PreloyersDeFinancement__c = 1.5,
                    CloseDate = Date.newInstance(2018,06,22),
                    FraisDeDossier__c = 7975,
                    QuotePartNL__c = 100,
                    Chantier__c = true,
                    DureDuChantierMois__c = 36
            );
            insert lOpportunity; 
            
                    BddRoe__c[] RefData=  new List<BddRoe__c>();

    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleRefinancementCMS'),TAUXCMS8ANS__C=0.815,TAUXCMS9ANS__C=0.931,TAUXCMS10ANS__C=1.035,TAUXCMS12ANS__C=1.208,TAUXCMS15ANS__C=1.386,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.36,TAUXVARIABLE__C=0.32,IDREFINANCEMENT__C=3.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.5,TAUXVARIABLE__C=0.4,IDREFINANCEMENT__C=4.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.64,TAUXVARIABLE__C=0.47,IDREFINANCEMENT__C=5.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.81,TAUXVARIABLE__C=0.55,IDREFINANCEMENT__C=6.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.95,TAUXVARIABLE__C=0.61,IDREFINANCEMENT__C=7.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.08,TAUXVARIABLE__C=0.64,IDREFINANCEMENT__C=8.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.2,TAUXVARIABLE__C=0.67,IDREFINANCEMENT__C=9.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.32,TAUXVARIABLE__C=0.7,IDREFINANCEMENT__C=10.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.43,TAUXVARIABLE__C=0.73,IDREFINANCEMENT__C=11.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.52,TAUXVARIABLE__C=0.74,IDREFINANCEMENT__C=12.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.6,TAUXVARIABLE__C=0.75,IDREFINANCEMENT__C=13.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.69,TAUXVARIABLE__C=0.77,IDREFINANCEMENT__C=14.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.76,TAUXVARIABLE__C=0.78,IDREFINANCEMENT__C=15.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.97,TAUXVARIABLE__C=0.83,IDREFINANCEMENT__C=18.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=2.1,TAUXVARIABLE__C=0.88,IDREFINANCEMENT__C=20.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.81,TAUXVARIABLE__C=0.8,IDREFINANCEMENT__C=16.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.86,TAUXVARIABLE__C=0.82,IDREFINANCEMENT__C=17.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=2.02,TAUXVARIABLE__C=0.85,IDREFINANCEMENT__C=19.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleRefinancementEuribor3mois'),EURIBOR3MOIS__C=-0.019,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Locaux de santé',LOCALISATION__C='1ère et 2ème couronne, Autres localisation',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=9.8,LIMITETAUXAMORTISSEMENT__C='>'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Retail - professionnels',USAGE__C='Usages autre que spécifique et industriels',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=15.0,LGD__C=16.5,LIMITETAUXAMORTISSEMENT__C='<'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Retail - professionnels',USAGE__C='Usages autre que spécifique et industriels',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=15.0,LGD__C=12.2,LIMITETAUXAMORTISSEMENT__C='>'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Locaux d\'activités, Messagerie',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=21.0,LGD__C=11.3,LIMITETAUXAMORTISSEMENT__C='>'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Locaux de santé',LOCALISATION__C='1ère et 2ème couronne, Autres localisation',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=10.8,LIMITETAUXAMORTISSEMENT__C='<'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Retail - professionnels',USAGE__C='Locaux industriels et spécifiques',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=0.0,LGD__C=25.2,LIMITETAUXAMORTISSEMENT__C='<',SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Bureaux et locaux professionnels / Locaux commerciaux',LOCALISATION__C='2ème couronne, Autres localisation',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=10.8,LIMITETAUXAMORTISSEMENT__C='<'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Locaux industriels et spécifiques',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=22.0,LGD__C=19.1,LIMITETAUXAMORTISSEMENT__C='<',SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Locaux de santé',LOCALISATION__C='Paris, Grande métropoles',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=10.1,LIMITETAUXAMORTISSEMENT__C='<'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Hôtellerie/Restauration, Entrepôts',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=10.8,LIMITETAUXAMORTISSEMENT__C='<',SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Bureaux et locaux professionnels / Locaux commerciaux',LOCALISATION__C='Paris, 1ère couronne, Grande métropoles',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=10.1,LIMITETAUXAMORTISSEMENT__C='<'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Hôtellerie/Restauration, Entrepôts',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=9.8,LIMITETAUXAMORTISSEMENT__C='>',SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Locaux d\'activités, Messagerie',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=21.0,LGD__C=14.6,LIMITETAUXAMORTISSEMENT__C='<'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Locaux industriels et spécifiques',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=22.0,LGD__C=19.1,LIMITETAUXAMORTISSEMENT__C='<',SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Bureaux et locaux professionnels / Locaux commerciaux',LOCALISATION__C='Paris, 1ère couronne, Grande métropoles',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=9.1,LIMITETAUXAMORTISSEMENT__C='>'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Locaux de santé',LOCALISATION__C='Paris, Grande métropoles',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=9.1,LIMITETAUXAMORTISSEMENT__C='>'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Locaux industriels et spécifiques',LOCALISATION__C='Toute localisation',VALEURTAUXAMORTISSEMENT__C=22.0,LGD__C=17.1,LIMITETAUXAMORTISSEMENT__C='>',SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('LGD'),TYPECONTREPARTIE__C='Corporate',USAGE__C='Bureaux et locaux professionnels / Locaux commerciaux',LOCALISATION__C='2ème couronne, Autres localisation',VALEURTAUXAMORTISSEMENT__C=7.0,LGD__C=9.8,LIMITETAUXAMORTISSEMENT__C='>'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.28,TAUXVARIABLE__C=0.6,IDREFINANCEMENT__C=17.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.23,TAUXVARIABLE__C=0.58,IDREFINANCEMENT__C=16.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.41,TAUXVARIABLE__C=0.64,IDREFINANCEMENT__C=19.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleTTR'),AAA__C=0.03,AAPLUS__C=0.03,AA__C=0.03,AAMOINS__C=0.03,APLUS__C=0.03,A__C=0.05,AMOINS__C=0.11,BBBPLUS__C=0.21,BBB__C=0.37,BBBMOINS__C=0.61,BBPLUS__C=0.96,BB__C=1.45,BBMOINS__C=2.1,BPLUS__C=2.96,B__C=4.09,BMOINS__C=5.52,CCCPLUS__C=7.31,CCC__C=9.51,CCCMOINS__C=12.21,CC__C=15.46,C__C=19.32,DX__C=99.99));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleRefinancementCMS'),TAUXCMS8ANS__C=0.517,TAUXCMS9ANS__C=0.6,TAUXCMS10ANS__C=0.676,TAUXCMS12ANS__C=0.807,TAUXCMS15ANS__C=0.95,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.0124,AAPLUS__C=0.0287,AA__C=0.056,AAMOINS__C=0.0905,APLUS__C=0.157,A__C=0.254,AMOINS__C=0.362,BBBPLUS__C=0.4892,BBB__C=0.6301,BBBMOINS__C=0.9217,BBPLUS__C=1.448,BB__C=2.5349,BBMOINS__C=3.272,BPLUS__C=4.3764,B__C=6.9339,BMOINS__C=9.1281,CCCPLUS__C=12.3512,CCC__C=14.1277,CCCMOINS__C=14.8036,CC__C=100.0,C__C=100.0,NDF__C=4.3764,ANNEE__C=2.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.0258,AAPLUS__C=0.0543,AA__C=0.0987,AAMOINS__C=0.1369,APLUS__C=0.2171,A__C=0.318,AMOINS__C=0.4327,BBBPLUS__C=0.5913,BBB__C=0.804,BBBMOINS__C=1.2561,BBPLUS__C=1.7971,BB__C=2.8315,BBMOINS__C=3.664,BPLUS__C=4.7816,B__C=6.153,BMOINS__C=7.6066,CCCPLUS__C=9.39,CCC__C=9.8635,CCCMOINS__C=9.7184,CC__C=100.0,C__C=100.0,NDF__C=4.4816,ANNEE__C=3.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.0433,AAPLUS__C=0.085,AA__C=0.1455,AAMOINS__C=0.1881,APLUS__C=0.2807,A__C=0.388,AMOINS__C=0.5135,BBBPLUS__C=0.7019,BBB__C=0.9721,BBBMOINS__C=1.5276,BBPLUS__C=2.079,BB__C=3.0125,BBMOINS__C=3.834,BPLUS__C=4.7848,B__C=5.4616,BMOINS__C=6.3399,CCCPLUS__C=7.1557,CCC__C=7.1166,CCCMOINS__C=6.8217,CC__C=100.0,C__C=100.0,NDF__C=4.7848,ANNEE__C=4.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.065,AAPLUS__C=0.1202,AA__C=0.196,AAMOINS__C=0.2433,APLUS__C=0.3471,A__C=0.463,AMOINS__C=0.6004,BBBPLUS__C=0.8144,BBB__C=1.1269,BBBMOINS__C=1.7398,BBPLUS__C=2.2888,BB__C=3.0984,BBMOINS__C=3.845,BPLUS__C=4.5846,B__C=4.8498,BMOINS__C=5.3154,CCCPLUS__C=5.5498,CCC__C=5.3202,CCCMOINS__C=5.0165,CC__C=100.0,C__C=100.0,NDF__C=4.5846,ANNEE__C=5.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.0907,AAPLUS__C=0.1595,AA__C=0.2497,AAMOINS__C=0.3018,APLUS__C=0.4155,A__C=0.54,AMOINS__C=0.69,BBBPLUS__C=0.9238,BBB__C=1.2638,BBBMOINS__C=1.8982,BBPLUS__C=2.4308,BB__C=3.111,BBMOINS__C=3.752,BPLUS__C=4.2926,B__C=4.3133,BMOINS__C=4.4985,CCCPLUS__C=4.4054,CCC__C=4.1127,CCCMOINS__C=3.8302,CC__C=100.0,C__C=100.0,NDF__C=4.2926,ANNEE__C=6.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.1202,AAPLUS__C=0.2025,AA__C=0.3059,AAMOINS__C=0.3628,APLUS__C=0.4849,A__C=0.618,AMOINS__C=0.7789,BBBPLUS__C=1.0264,BBB__C=1.3806,BBBMOINS__C=2.0098,BBPLUS__C=2.5137,BB__C=3.0696,BBMOINS__C=3.597,BPLUS__C=3.9701,B__C=3.8468,BMOINS__C=3.8494,CCCPLUS__C=3.5822,CCC__C=3.2773,CCCMOINS__C=3.0207,CC__C=100.0,C__C=100.0,NDF__C=3.9701,ANNEE__C=7.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.1533,AAPLUS__C=0.2485,AA__C=0.3639,AAMOINS__C=0.4254,APLUS__C=0.5544,A__C=0.695,AMOINS__C=0.8649,BBBPLUS__C=1.1199,BBB__C=1.4769,BBBMOINS__C=2.0817,BBPLUS__C=2.5479,BB__C=2.9905,BBMOINS__C=3.409,BPLUS__C=3.6492,B__C=3.4434,BMOINS__C=3.3315,CCCPLUS__C=2.9794,CCC__C=2.6826,CCCMOINS__C=2.4509,CC__C=100.0,C__C=100.0,NDF__C=3.6492,ANNEE__C=8.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.1897,AAPLUS__C=0.2972,AA__C=0.423,AAMOINS__C=0.4889,APLUS__C=0.623,A__C=0.77,AMOINS__C=0.946,BBBPLUS__C=1.2028,BBB__C=1.5534,BBBMOINS__C=2.121,BBPLUS__C=2.5437,BB__C=2.8867,BBMOINS__C=3.208,BPLUS__C=3.346,B__C=3.0952,BMOINS__C=2.915,CCCPLUS__C=2.5283,CCC__C=2.2475,CCCMOINS__C=2.038,CC__C=100.0,C__C=100.0,NDF__C=3.346,ANNEE__C=9.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.2291,AAPLUS__C=0.3477,AA__C=0.4827,AAMOINS__C=0.5523,APLUS__C=0.6899,A__C=0.842,AMOINS__C=1.0209,BBBPLUS__C=1.2746,BBB__C=1.6117,BBBMOINS__C=2.134,BBPLUS__C=2.5105,BB__C=2.768,BBMOINS__C=3.005,BPLUS__C=3.0672,B__C=2.7947,BMOINS__C=2.5763,CCCPLUS__C=2.1828,CCC__C=1.9205,CCCMOINS__C=1.7306,CC__C=100.0,C__C=100.0,NDF__C=3.0672,ANNEE__C=10.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.2709,AAPLUS__C=0.3997,AA__C=0.5421,AAMOINS__C=0.6151,APLUS__C=0.7544,A__C=0.909,AMOINS__C=1.0888,BBBPLUS__C=1.3352,BBB__C=1.6535,BBBMOINS__C=2.1264,BBPLUS__C=2.4562,BB__C=2.6416,BBMOINS__C=2.808,BPLUS__C=2.8147,B__C=2.5347,BMOINS__C=2.2976,CCCPLUS__C=1.9123,CCC__C=1.6685,CCCMOINS__C=1.4958,CC__C=100.0,C__C=100.0,ANNEE__C=11.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.3149,AAPLUS__C=0.4526,AA__C=0.6008,AAMOINS__C=0.6764,APLUS__C=0.8158,A__C=0.971,AMOINS__C=1.1491,BBBPLUS__C=1.385,BBB__C=1.681,BBBMOINS__C=2.1029,BBPLUS__C=2.3874,BB__C=2.5127,BBMOINS__C=2.621,BPLUS__C=2.5879,B__C=2.309,BMOINS__C=2.0653,CCCPLUS__C=1.6957,CCC__C=1.4698,CCCMOINS__C=1.3121,CC__C=100.0,C__C=100.0,ANNEE__C=12.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.3605,AAPLUS__C=0.5057,AA__C=0.6583,AAMOINS__C=0.7358,APLUS__C=0.8738,A__C=1.028,AMOINS__C=1.2019,BBBPLUS__C=1.4247,BBB__C=1.6962,BBBMOINS__C=2.0677,BBPLUS__C=2.309,BB__C=2.3849,BBMOINS__C=2.447,BPLUS__C=2.385,B__C=2.1122,BMOINS__C=1.8696,CCCPLUS__C=1.5191,CCC__C=1.3096,CCCMOINS__C=1.165,CC__C=100.0,C__C=100.0,ANNEE__C=13.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.4074,AAPLUS__C=0.5587,AA__C=0.7139,AAMOINS__C=0.7927,APLUS__C=0.928,A__C=1.08,AMOINS__C=1.2471,BBBPLUS__C=1.4551,BBB__C=1.7009,BBBMOINS__C=2.0238,BBPLUS__C=2.2251,BB__C=2.2607,BBMOINS__C=2.285,BPLUS__C=2.2036,B__C=1.9398,BMOINS__C=1.7027,CCCPLUS__C=1.3723,CCC__C=1.178,CCCMOINS__C=1.0449,CC__C=100.0,C__C=100.0,ANNEE__C=14.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.455,AAPLUS__C=0.611,AA__C=0.7674,AAMOINS__C=0.8467,APLUS__C=0.9781,A__C=1.126,AMOINS__C=1.2852,BBBPLUS__C=1.4771,BBB__C=1.6971,BBBMOINS__C=1.974,BBPLUS__C=2.1386,BB__C=2.1415,BBMOINS__C=2.137,BPLUS__C=2.0413,B__C=1.788,BMOINS__C=1.559,CCCPLUS__C=1.2486,CCC__C=1.068,CCCMOINS__C=0.9451,CC__C=100.0,C__C=100.0,ANNEE__C=15.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.455,AAPLUS__C=0.611,AA__C=0.7674,AAMOINS__C=0.8467,APLUS__C=0.9781,A__C=1.1256,AMOINS__C=1.2852,BBBPLUS__C=1.4771,BBB__C=1.6971,BBBMOINS__C=1.974,BBPLUS__C=2.1386,BB__C=2.1415,BBMOINS__C=2.1368,BPLUS__C=2.0413,B__C=1.788,BMOINS__C=1.559,CCCPLUS__C=1.2486,CCC__C=1.068,CCCMOINS__C=0.9451,CC__C=100.0,C__C=100.0,ANNEE__C=16.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.455,AAPLUS__C=0.611,AA__C=0.7674,AAMOINS__C=0.8467,APLUS__C=0.9781,A__C=1.1256,AMOINS__C=1.2852,BBBPLUS__C=1.4771,BBB__C=1.6971,BBBMOINS__C=1.974,BBPLUS__C=2.1386,BB__C=2.1415,BBMOINS__C=2.1368,BPLUS__C=2.0413,B__C=1.788,BMOINS__C=1.559,CCCPLUS__C=1.2486,CCC__C=1.068,CCCMOINS__C=0.9451,CC__C=100.0,C__C=100.0,ANNEE__C=17.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.455,AAPLUS__C=0.611,AA__C=0.7674,AAMOINS__C=0.8467,APLUS__C=0.9781,A__C=1.1256,AMOINS__C=1.2852,BBBPLUS__C=1.4771,BBB__C=1.6971,BBBMOINS__C=1.974,BBPLUS__C=2.1386,BB__C=2.1415,BBMOINS__C=2.1368,BPLUS__C=2.0413,B__C=1.788,BMOINS__C=1.559,CCCPLUS__C=1.2486,CCC__C=1.068,CCCMOINS__C=0.9451,CC__C=100.0,C__C=100.0,ANNEE__C=18.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.455,AAPLUS__C=0.611,AA__C=0.7674,AAMOINS__C=0.8467,APLUS__C=0.9781,A__C=1.1256,AMOINS__C=1.2852,BBBPLUS__C=1.4771,BBB__C=1.6971,BBBMOINS__C=1.974,BBPLUS__C=2.1386,BB__C=2.1415,BBMOINS__C=2.1368,BPLUS__C=2.0413,B__C=1.788,BMOINS__C=1.559,CCCPLUS__C=1.2486,CCC__C=1.068,CCCMOINS__C=0.9451,CC__C=100.0,C__C=100.0,ANNEE__C=19.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleProjectionPdSp'),AAA__C=0.455,AAPLUS__C=0.611,AA__C=0.7674,AAMOINS__C=0.8467,APLUS__C=0.9781,A__C=1.1256,AMOINS__C=1.2852,BBBPLUS__C=1.4771,BBB__C=1.6971,BBBMOINS__C=1.974,BBPLUS__C=2.1386,BB__C=2.1415,BBMOINS__C=2.1368,BPLUS__C=2.0413,B__C=1.788,BMOINS__C=1.559,CCCPLUS__C=1.2486,CCC__C=1.068,CCCMOINS__C=0.9451,CC__C=100.0,C__C=100.0,ANNEE__C=20.0));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=2.0,BPCENATIXISNIECOMPTESSOCIAUX__C=0.035,CENATIXISNIO__C=0.79,BPNATIXISNIO__C=0.66,TRANSCOSPRETAIL__C=8.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=3.0,BPCENATIXISNIECOMPTESSOCIAUX__C=0.057,CENATIXISNIO__C=1.38,BPNATIXISNIO__C=1.15,TRANSCOSPRETAIL__C=10.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=4.0,BPCENATIXISNIECOMPTESSOCIAUX__C=0.092,CENATIXISNIO__C=2.39,BPNATIXISNIO__C=1.99,TRANSCOSPRETAIL__C=11.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('Entete'),COUTREFINANCEMENTCT__C=0.25,MARGEBANCAIRE__C=77.3,CHARGES__C=39.4,POURCENTAGEBESOINSFP__C=9.0,TAUXREMUNERATIONFP__C=3.0,TAUX_IS__C=36.0,TAUXTVA__C=20.0,SCALINGFACTOR__C=1.06,POURCENTAGERISQUERWA__C=0.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.07,TAUXVARIABLE__C=0.54,IDREFINANCEMENT__C=13.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.18,TAUXVARIABLE__C=0.56,IDREFINANCEMENT__C=15.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.49,TAUXVARIABLE__C=0.39,IDREFINANCEMENT__C=5.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.01,TAUXVARIABLE__C=0.53,IDREFINANCEMENT__C=12.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.65,TAUXVARIABLE__C=0.45,IDREFINANCEMENT__C=7.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.88,TAUXVARIABLE__C=0.51,IDREFINANCEMENT__C=10.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.58,TAUXVARIABLE__C=0.43,IDREFINANCEMENT__C=6.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.41,TAUXVARIABLE__C=0.39,IDREFINANCEMENT__C=4.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.73,TAUXVARIABLE__C=0.48,IDREFINANCEMENT__C=8.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.34,TAUXVARIABLE__C=0.3,IDREFINANCEMENT__C=3.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.36,TAUXVARIABLE__C=0.62,IDREFINANCEMENT__C=18.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.48,TAUXVARIABLE__C=0.67,IDREFINANCEMENT__C=20.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.94,TAUXVARIABLE__C=0.52,IDREFINANCEMENT__C=11.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=2.0,COTATION1__C=0.000559638,COTATION2__C=0.000904959,COTATION3__C=0.001569643,COTATION4__C=0.0025414,COTATION5__C=0.003620447,COTATION6__C=0.004892193,COTATION7__C=0.006300991,COTATION8__C=0.009216953,COTATION9__C=0.014480295,COTATION10__C=0.025348965,COTATION11__C=0.032718321,COTATION12__C=0.043763589,COTATION13__C=0.069339417,COTATION14__C=0.091280706,COTATION15__C=0.148035528,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=3.0,COTATION1__C=0.000986556,COTATION2__C=0.001369025,COTATION3__C=0.002171389,COTATION4__C=0.0031803,COTATION5__C=0.004327165,COTATION6__C=0.00591286,COTATION7__C=0.008039771,COTATION8__C=0.012560649,COTATION9__C=0.017970725,COTATION10__C=0.028315326,COTATION11__C=0.036642291,COTATION12__C=0.047815758,COTATION13__C=0.061529956,COTATION14__C=0.076066338,COTATION15__C=0.097183535,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=4.0,COTATION1__C=0.001454746,COTATION2__C=0.001880564,COTATION3__C=0.002807303,COTATION4__C=0.003883,COTATION5__C=0.005134869,COTATION6__C=0.007018571,COTATION7__C=0.009721037,COTATION8__C=0.015276145,COTATION9__C=0.020789775,COTATION10__C=0.030124928,COTATION11__C=0.038336675,COTATION12__C=0.047847593,COTATION13__C=0.054615868,COTATION14__C=0.063398967,COTATION15__C=0.068217129,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=5.0,COTATION1__C=0.001959958,COTATION2__C=0.002432757,COTATION3__C=0.003471384,COTATION4__C=0.0046304,COTATION5__C=0.006004373,COTATION6__C=0.008143642,COTATION7__C=0.01126894,COTATION8__C=0.017397742,COTATION9__C=0.022888371,COTATION10__C=0.030984485,COTATION11__C=0.038445894,COTATION12__C=0.045845787,COTATION13__C=0.048497601,COTATION14__C=0.053154014,COTATION15__C=0.050165131,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=6.0,COTATION1__C=0.002496664,COTATION2__C=0.003017962,COTATION3__C=0.004155229,COTATION4__C=0.0054032,COTATION5__C=0.006899548,COTATION6__C=0.009237547,COTATION7__C=0.012637908,COTATION8__C=0.018982113,COTATION9__C=0.024308127,COTATION10__C=0.031109853,COTATION11__C=0.037519267,COTATION12__C=0.042926131,COTATION13__C=0.04313281,COTATION14__C=0.044985148,COTATION15__C=0.038301722,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=7.0,COTATION1__C=0.003058507,COTATION2__C=0.003627981,COTATION3__C=0.004849313,COTATION4__C=0.0061833,COTATION5__C=0.00778948,COTATION6__C=0.010263934,COTATION7__C=0.013806127,COTATION8__C=0.020097882,COTATION9__C=0.025136763,COTATION10__C=0.030695935,COTATION11__C=0.035971132,COTATION12__C=0.039700528,COTATION13__C=0.038468111,COTATION14__C=0.038493553,COTATION15__C=0.030207208,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=8.0,COTATION1__C=0.003638694,COTATION2__C=0.004254386,COTATION3__C=0.005543939,COTATION4__C=0.0069544,COTATION5__C=0.008649316,COTATION6__C=0.011198755,COTATION7__C=0.014769175,COTATION8__C=0.020817215,COTATION9__C=0.025478573,COTATION10__C=0.029905438,COTATION11__C=0.034092462,COTATION12__C=0.036491935,COTATION13__C=0.034433764,COTATION14__C=0.033315129,COTATION15__C=0.024508594,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=9.0,COTATION1__C=0.00423033,COTATION2__C=0.004888845,COTATION3__C=0.006229901,COTATION4__C=0.0077029,COTATION5__C=0.009460276,COTATION6__C=0.012028059,COTATION7__C=0.015534486,COTATION8__C=0.021209963,COTATION9__C=0.02543691,COTATION10__C=2.8867,COTATION11__C=0.032077131,COTATION12__C=0.033459609,COTATION13__C=0.030952326,COTATION14__C=0.029149822,COTATION15__C=0.020379996,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=10.0,COTATION1__C=0.00482667,COTATION2__C=0.005523395,COTATION3__C=0.006898887,COTATION4__C=0.0084174,COTATION5__C=0.010209158,COTATION6__C=0.01274578,COTATION7__C=0.016116891,COTATION8__C=0.021340089,COTATION9__C=0.025105032,COTATION10__C=0.02767997,COTATION11__C=0.030048283,COTATION12__C=0.03067171,COTATION13__C=0.027947038,COTATION14__C=0.025762888,COTATION15__C=0.017306419,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=11.0,COTATION1__C=0.005421322,COTATION2__C=0.00615066,COTATION3__C=0.00754372,COTATION4__C=0.0090893,COTATION5__C=0.01088759,COTATION6__C=0.013351716,COTATION7__C=0.016535239,COTATION8__C=0.021263875,COTATION9__C=0.024562301,COTATION10__C=0.026415892,COTATION11__C=0.028080038,COTATION12__C=0.028147132,COTATION13__C=0.02534705,COTATION14__C=0.022975554,COTATION15__C=0.014958388,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=12.0,COTATION1__C=0.006008386,COTATION2__C=0.006764005,COTATION3__C=0.008158451,COTATION4__C=0.0097123,COTATION5__C=0.011491184,COTATION6__C=0.013849803,COTATION7__C=0.016809982,COTATION8__C=0.021029354,COTATION9__C=0.023873518,COTATION10__C=0.025127033,COTATION11__C=0.026213764,COTATION12__C=0.025879371,COTATION13__C=0.023089845,COTATION14__C=0.020653383,COTATION15__C=0.013120658,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=13.0,COTATION1__C=0.006582551,COTATION2__C=0.007357631,COTATION3__C=0.00873837,COTATION4__C=0.0102824,COTATION5__C=0.012018707,COTATION6__C=0.014246707,COTATION7__C=0.016961532,COTATION8__C=0.020676538,COTATION9__C=0.023089937,COTATION10__C=0.023849381,COTATION11__C=0.024469652,COTATION12__C=0.023849942,COTATION13__C=0.021121812,COTATION14__C=0.018695653,COTATION15__C=0.011649911,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=14.0,COTATION1__C=0.007139151,COTATION2__C=0.007926624,COTATION3__C=0.009279949,COTATION4__C=0.0107973,COTATION5__C=0.012471314,COTATION6__C=0.014550723,COTATION7__C=0.017009229,COTATION8__C=0.020238092,COTATION9__C=0.022251027,COTATION10__C=0.02260694,COTATION11__C=0.02285465,COTATION12__C=0.022035749,COTATION13__C=0.019397794,COTATION14__C=0.017026746,COTATION15__C=0.010448959,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=15.0,COTATION1__C=0.007674191,COTATION2__C=0.008466956,COTATION3__C=0.009780749,COTATION4__C=0.0112563,COTATION5__C=0.012851891,COTATION6__C=0.014770948,COTATION7__C=0.016970754,COTATION8__C=0.019740222,COTATION9__C=0.02138645,COTATION10__C=0.021414912,COTATION11__C=0.021367739,COTATION12__C=0.020412993,COTATION13__C=0.017880155,COTATION14__C=0.015589547,COTATION15__C=0.009450685,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=16.0,COTATION1__C=0.007674191,COTATION2__C=0.008466956,COTATION3__C=0.009780749,COTATION4__C=0.0128519,COTATION5__C=0.0128519,COTATION6__C=0.014770948,COTATION7__C=0.016970754,COTATION8__C=0.019740222,COTATION9__C=0.02138645,COTATION10__C=0.021414912,COTATION11__C=0.021367739,COTATION12__C=0.020412993,COTATION13__C=0.017880155,COTATION14__C=0.015589547,COTATION15__C=0.009450685,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=17.0,COTATION1__C=0.007674191,COTATION2__C=0.008466956,COTATION3__C=0.009780749,COTATION4__C=0.0112563,COTATION5__C=0.0128519,COTATION6__C=0.014770948,COTATION7__C=0.016970754,COTATION8__C=0.019740222,COTATION9__C=0.02138645,COTATION10__C=0.021414912,COTATION11__C=0.021367739,COTATION12__C=0.020412993,COTATION13__C=0.017880155,COTATION14__C=0.015589547,COTATION15__C=0.009450685,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=18.0,COTATION1__C=0.007674191,COTATION2__C=0.008466956,COTATION3__C=0.009780749,COTATION4__C=0.0112563,COTATION5__C=0.0128519,COTATION6__C=0.014770948,COTATION7__C=0.016970754,COTATION8__C=0.019740222,COTATION9__C=0.02138645,COTATION10__C=0.021414912,COTATION11__C=0.021367739,COTATION12__C=0.020412993,COTATION13__C=0.017880155,COTATION14__C=0.015589547,COTATION15__C=0.009450685,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=19.0,COTATION1__C=0.007674191,COTATION2__C=0.008466956,COTATION3__C=0.009780749,COTATION4__C=0.0112563,COTATION5__C=0.0128519,COTATION6__C=0.014770948,COTATION7__C=0.016970754,COTATION8__C=0.019740222,COTATION9__C=0.02138645,COTATION10__C=0.021414912,COTATION11__C=0.021367739,COTATION12__C=0.020412993,COTATION13__C=0.017880155,COTATION14__C=0.015589547,COTATION15__C=0.009450685,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleCotation'),ANNEE__C=20.0,COTATION1__C=0.007674191,COTATION2__C=0.008466956,COTATION3__C=0.009780749,COTATION4__C=0.0112563,COTATION5__C=0.0128519,COTATION6__C=0.014770948,COTATION7__C=0.016970754,COTATION8__C=0.019740222,COTATION9__C=0.02138645,COTATION10__C=0.021414912,COTATION11__C=0.021367739,COTATION12__C=0.020412993,COTATION13__C=0.017880155,COTATION14__C=0.015589547,COTATION15__C=0.009450685,COTATION16__C=1.0,SEMAINECONSTATATION__C='32-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=1.13,TAUXVARIABLE__C=0.55,IDREFINANCEMENT__C=14.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillesRefinancementTfTv'),TAUXFIXE__C=0.81,TAUXVARIABLE__C=0.5,IDREFINANCEMENT__C=9.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrilleRefinancementEuribor3mois'),EURIBOR3MOIS__C=0.039,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=5.0,BPCENATIXISNIECOMPTESSOCIAUX__C=0.149,CENATIXISNIO__C=4.15,BPNATIXISNIO__C=3.46,TRANSCOSPRETAIL__C=12.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=6.0,BPCENATIXISNIECOMPTESSOCIAUX__C=0.242,CENATIXISNIO__C=7.22,BPNATIXISNIO__C=6.02,TRANSCOSPRETAIL__C=13.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=7.0,BPCENATIXISNIECOMPTESSOCIAUX__C=0.394,CENATIXISNIO__C=12.59,BPNATIXISNIO__C=10.49,TRANSCOSPRETAIL__C=14.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=8.0,BPCENATIXISNIECOMPTESSOCIAUX__C=0.639,CENATIXISNIO__C=21.82,BPNATIXISNIO__C=18.18,TRANSCOSPRETAIL__C=15.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=9.0,BPCENATIXISNIECOMPTESSOCIAUX__C=1.038,CENATIXISNIO__C=31.71,BPNATIXISNIO__C=31.71,TRANSCOSPRETAIL__C=16.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=10.0,BPCENATIXISNIECOMPTESSOCIAUX__C=1.686,CENATIXISNIO__C=61.77,BPNATIXISNIO__C=61.77,TRANSCOSPRETAIL__C=16.0,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=11.0,BPCENATIXISNIECOMPTESSOCIAUX__C=2.738,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=12.0,BPCENATIXISNIECOMPTESSOCIAUX__C=4.448,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=13.0,BPCENATIXISNIECOMPTESSOCIAUX__C=7.224,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=14.0,BPCENATIXISNIECOMPTESSOCIAUX__C=11.733,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=15.0,BPCENATIXISNIECOMPTESSOCIAUX__C=19.056,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=16.0,BPCENATIXISNIECOMPTESSOCIAUX__C=30.95,SEMAINECONSTATATION__C='20-2015'));
    RefData.add(new BddRoe__c(RecordTypeId=mapBDD_RT.get('GrillePD'),RATINREFPD__C=1.0,BPCENATIXISNIECOMPTESSOCIAUX__C=0.03,CENATIXISNIO__C=0.46,BPNATIXISNIO__C=0.38,TRANSCOSPRETAIL__C=7.0));

            insert RefData;
            
            Test.startTest();
            
            CalculetteROE__c CROE=  new CalculetteROE__c(
              CalculetteROEValidee__c = true,
              SemaineConstatationTaux__c = '32-2015',
              ProjetAssocie__c = lOpportunity.id,
              MontantduCBI__c =  3950000,
              //MontantBrutDeLaQPNL__c = 3950000,  
             // MontantVRQPNLSimulation__c = 0,  
              ModeDeCalcul__c ='TEA', 
              AvancePreneur__c = 0,
              MontantAVPRNL__c = 0,
              // MontantAVPRNL__c = '1160000',
              DureeEnTrimestre__c = 48, 
              FraisDeDossier__c = 6000,// Dans calculette saisie par commercial 
              DureeDuChantierMois__c = 12, 
              PremierTiragePhaseChantier__c = 0,  
              ValeurResiduelle__c = 0,
              SpreadRemunerationPreloyersTVA__c = 1.5,
              SpreadRemunerationPreloyers__c = 1.5,
              //MontantTVA__c = 546000,
              PreloyersEngagementPerc__c = 0.10,
              CommissionNonUtilisationEnSpread__c = 0,
              ValeurDuBien__c = 10228275,
              EncoursTotalDuDossier__c = 0,
              DureePreloyersTVA__c = '4',
              TauxRemunerationAvancePreneur__c = 0,
              TypeDeTaux__c = 'Taux variable Euribor 3 mois',
               TypeTauxRefinancement__c  = 'Taux refi NL',
                SpreadIndex365360__c = 2.10,
                TypeContrepartie__c = 'Corporate',
                BaseNotation__c = 'NIE NEW 2012 - BPCE',
                NotationNIE1to16__c = '12',
                UsageROE__c = 'Locaux industriels et spécifiques',
                LocatisationROE__c = 'Toute localisation',
                CommissionApportFlat__c = 7975,
                CommissionDeRisqueActualiseeBPCE__c =0.88,
                PrecisezProvenanceDuRefinancement__c = 'Class Test',
                QuotePartNL__c = 100
            );
            insert CROE;
            
            Test.stopTest();
        }

    }
    
    static testmethod void testQuoteControllerNewPropal(){

        User u = [Select ID, UserByPassTriggers__c from User ORDER BY CreatedDate DESC LIMIT 1];

        System.runAs(u){
        
            Date CloseDate = Date.newInstance(2999,06,23);
            
            CalculetteROE__c calc = [SELECT Id FROM CalculetteROE__c WHERE PrecisezProvenanceDuRefinancement__c = 'Class Test'];
          
            ApexPages.currentPage().getParameters().put('ID',calc.id);
            ApexPages.currentPage().getParameters().put('NbPropositionCommerciale','1');
            ApexPages.currentPage().getParameters().put('NbPropositionCommercialeEnvoye','1');
            ApexPages.currentPage().getParameters().put('CalculetteROEValidee','1');
          
            ApexPages.StandardController stdCalc = new ApexPages.StandardController(calc);
            Ctrl08_Quote quoteController = new Ctrl08_Quote(stdCalc);
            
            Test.startTest();
            
            quoteController.getNbPropositionCommerciale(calc.Id);
            quoteController.getNbPropositionCommercialeEnvoye(calc.Id);
            quoteController.SaveNewPropositionCommerciale();

            quoteController.Fermer();
            
            Test.stopTest();
        }      
        
    }
    
    static testmethod void testQuoteControllerMAJPropal(){
        
        Date CloseDate = Date.newInstance(2999,06,23);
        
        CalculetteROE__c calc = [SELECT Id FROM CalculetteROE__c WHERE PrecisezProvenanceDuRefinancement__c = 'Class Test'];
      
        ApexPages.currentPage().getParameters().put('ID',calc.id);
        ApexPages.currentPage().getParameters().put('NbPropositionCommerciale','1');
        ApexPages.currentPage().getParameters().put('NbPropositionCommercialeEnvoye','1');
        ApexPages.currentPage().getParameters().put('CalculetteROEValidee','1');
      
        ApexPages.StandardController stdCalc = new ApexPages.StandardController(calc);
        Ctrl08_Quote quoteController = new Ctrl08_Quote(stdCalc);
        
        Test.startTest();
        
        quoteController.getNbPropositionCommerciale(calc.Id);
        quoteController.getNbPropositionCommercialeEnvoye(calc.Id);
  
        quoteController.SaveMAJPropositionCommerciale();
        
        quoteController.Fermer();
        
        Test.stopTest();
        
        
        
    }
    
}